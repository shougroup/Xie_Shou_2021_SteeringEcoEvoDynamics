function J=chem_Exploit_jacobian(t, y, paras)

B = y(1);
R = y(2);
A = y(3);

gM_maxM_L = paras.gM_maxM_L;
gH_maxH_L=paras.gH_maxH_L;
c_BM = paras.c_BM;
c_RM = paras.c_RM;
c_RH = paras.c_RH;
K_MB = paras.K_MB;
K_MR = paras.K_MR;
K_HR = paras.K_HR;
K_HA = paras.K_HA;
fp = paras.fp;

BN = B./K_MB;
RN_M = R./K_MR;
RN_H = R./K_HR;
AN = A./K_HA;

% M_coef = BN./(RN_M+BN).*RN_M./(RN_M+1) + RN_M./(RN_M+BN).*BN./(BN+1);
% H_coef = RN_H./(RN_H+1) ./(AN+1);


dM_coefdB = RN_M.^2./(RN_M+BN).^2./(RN_M+1) ...
    + RN_M.*(1-BN.^2)./(RN_M+BN).^2./(BN+1).^2;
dM_coefdR = BN.^2./(RN_M+BN).^2./(BN+1) ...
    + BN.*(1-RN_M.^2)./(RN_M+BN).^2./(RN_M+1).^2;
dH_coefdR = 1./(RN_H+1).^2./K_HR ./ (AN+1);
dH_coefdA = - RN_H./(RN_H+1) ./(AN+1).^2 ./K_HA;
dM_coefdB = dM_coefdB./K_MB;
dM_coefdR = dM_coefdR./K_MR;

% dB = -sum(c_BM*gM_maxM_L.*M_coef) + sum(gH_maxH_L.*H_coef);
% dR = -sum(c_RM*gM_maxM_L.*M_coef) - sum(c_RH*gH_maxH_L.*H_coef);
% dA = sum(gM_maxM_L.*M_coef.*(1-fp));

J11 = -sum(c_BM*gM_maxM_L.*dM_coefdB);
J12 = -sum(c_BM*gM_maxM_L.*dM_coefdR) + sum(gH_maxH_L.*dH_coefdR);
J13 =  sum(gH_maxH_L.*dH_coefdA);
J21 = -sum(c_RM*gM_maxM_L.*dM_coefdB);
J22 = -sum(c_RM*gM_maxM_L.*dM_coefdR) - sum(c_RH*gH_maxH_L.*dH_coefdR);
J23 = -sum(c_RH*gH_maxH_L.*dH_coefdA);
J31 = sum(gM_maxM_L.*dM_coefdB.*(1-fp));
J32 = sum(gM_maxM_L.*dM_coefdR.*(1-fp));
J=[J11 J12 J13; J21 J22 J23; J31 J32 0];